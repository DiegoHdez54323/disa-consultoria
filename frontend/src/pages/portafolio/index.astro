---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Footer from "../../components/Footer.astro";
import { PortfolioHero } from "../../components/portfolio/PortfolioHero";
import { PortfolioFeed } from "../../components/portfolio/PortfolioFeed";
import CTASection from "../../components/services/CTASection.astro"; // Reutilizamos el de servicios si es igual, o creamos uno nuevo

// Data Fetching
import { getAllPortfolioProjects } from "../../services/portfolioService";
import type { PortfolioProject } from "../../sanity/types/portfolio";

const projects: PortfolioProject[] = await getAllPortfolioProjects();
---

<BaseLayout
  title="Portafolio | DiSa Consultoría"
  description="Explora nuestros casos de éxito en desarrollo web, apps móviles y soluciones empresariales."
  canonicalURL={new URL("/portafolio", Astro.site)}
>
  <main class="min-h-screen bg-background overflow-hidden">
    {/* 1. Hero con Animaciones Complejas (React Client Load) */}
    <PortfolioHero client:load />

    {/* 2. Grid de Proyectos con Filtros (React Client Visible) */}
    {/* Pasamos los proyectos cargados desde Sanity */}
    <PortfolioFeed client:visible projects={projects} />

    {
      /* 3. CTA (Static Astro o React según prefieras, aquí reutilizamos el de servicios) */
    }
    <CTASection />

    {
      /* Footer eliminado para evitar duplicación ya que BaseLayout lo incluye */
    }
  </main>
</BaseLayout>
