---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Footer from "../../components/Footer.astro";
import { PortfolioHero } from "../../components/portfolio/PortfolioHero";
import { PortfolioFeed } from "../../components/portfolio/PortfolioFeed";
import CTASection from "../../components/services/CTASection.astro"; // Reutilizamos el de servicios si es igual, o creamos uno nuevo

// Data Fetching
import { getAllPortfolioProjects } from "../../services/portfolioService";
import type { PortfolioProject } from "../../sanity/types/portfolio";

const projects: PortfolioProject[] = await getAllPortfolioProjects();

// Contador de proyectos
const totalProjects = projects.length;
---

<BaseLayout
  title="Portafolio | DiSa Consultoría"
  description="Explora nuestros casos de éxito en desarrollo web, apps móviles y soluciones empresariales."
  canonicalURL={new URL("/portafolio", Astro.site)}
>
  <main class="min-h-screen bg-background overflow-hidden">
    <PortfolioHero client:load projectCount={totalProjects} />

    <PortfolioFeed client:visible projects={projects}/>

    <CTASection />

  </main>
</BaseLayout>
